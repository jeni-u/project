<!DOCTYPE html>
<html lang="en">

<head>
   <!-- basic -->
   <meta charset="utf-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <!-- mobile metas -->
   <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
   <!-- site metas -->
   <title>Blogg</title>
   <meta name="keywords" content="">
   <meta name="description" content="">
   <meta name="author" content="">
   <!-- bootstrap css -->
   <link rel="stylesheet" href="../static/css/bootstrap.min.css">
   <!-- style css -->
   <link rel="stylesheet" href="../static/css/style.css">
   <!-- Responsive-->
   <link rel="stylesheet" href="../static/css/responsive.css">
   <!-- fevicon -->
   <link rel="icon" href="../static/css/images/fevicon.png" type="image/gif" />
   <!-- Scrollbar Custom CSS -->
   <link rel="stylesheet" href="../static/css/jquery.mCustomScrollbar.min.css">
   <!-- Tweaks for older IEs-->
   <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
   <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css"
      media="screen">
   <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
</head>
<!-- body -->
<style>
   .modal-body ul {
     max-height: 300px;
     overflow-y: auto;
   }
 </style>
 

<body class="main-layout">
   <!-- loader  -->
   <div class="loader_bg">
      <div class="loader"><img src="../static/images/loading.gif" alt="#" /></div>
   </div>
   <!-- end loader -->
   <!-- header -->
   <header>
      <!-- header inner -->
      <div class="head_top">
         <div class="header">
            <div class="container-fluid">
               <div class="row">
                  <div class="col-xl-3 col-lg-3 col-md-3 col-sm-3 col logo_section">
                     <div class="full">
                        <div class="center-desk">
                           <div class="logo">
                              <a href="/"><img src="../static/images/logo.png" alt="#" /></a>
                           </div>
                        </div>
                     </div>
                  </div>
                  <div class="col-xl-9 col-lg-9 col-md-9 col-sm-9">
                     <nav class="navigation navbar navbar-expand-md navbar-dark ">
                        <button class="navbar-toggler" type="button" data-toggle="collapse"
                           data-target="#navbarsExample04" aria-controls="navbarsExample04" aria-expanded="false"
                           aria-label="Toggle navigation">
                           <span class="navbar-toggler-icon"></span>
                        </button>
                        <div class="collapse navbar-collapse" id="navbarsExample04">
                           <ul class="navbar-nav mr-auto">
                              <li class="nav-item">
                                 <a class="nav-link" href="/bloggs"> Dashboard </a>
                              </li>
                              <li class="nav-item">
                                 <a class="nav-link" href="/about">About</a>
                              </li>
                              <li class="nav-item">
                                 <a class="nav-link" href="/contact">Contact</a>
                              </li>
                              <li class="nav-item ">
                                 <a class="nav-link" href="/login"> LOGIN </a>
                              </li>
                              <li class="nav-item">
                                 <a class="nav-link" href="/register"> REGISTER</a>
                              </li>
                              <li class="nav-item">
                                 <a class="nav-link" href="/logout"> LOGOUT</a>
                              </li>
                           </ul>
                        </div>
                     </nav>
                  </div>
               </div>
            </div>
         </div>
         <!-- end header inner -->
         <!-- end header -->
         <!-- banner -->
         <section class="banner_main">
            <div class="container">
               <div class="row d_flex">
                  <div class=" col-xl-8 col-lg-8 col-md-8 col-12-9">
                     <div class="text-bg">
                        <h1>Blog<br> <span class="white1">Landing Page 2024</span></h1>
                        <p>It is a long established fact that a reader will be distracted by the readable content of a
                           page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less
                           normal distribution of letters</p>
                        <a href="/login">Collaborate with Us</a>
                     </div>
                  </div>
                  <div class="col-xl-4 col-lg-4 col-md-4 col-12-3">
                     <div class="text-img">
                        <figure><img src="../static/images/box_img.png" alt="#" /></figure>
                     </div>
                  </div>
               </div>
            </div>
         </section>
      </div>
   </header>
   <!-- end banner -->
   <!-- Blog Main -->
   <div class="blog_main">
      <div class="container">
         <div class="row">
            <div class="col-md-12">
               <div class="titlepage">
                  <h2>Our Blogs</h2>
                  <span>It is a long established fact that a reader will be distracted by the readable content of a
                     page</span>
               </div>
            </div>
         </div>
         <div class="row">
            {% for post in posts %}
            <div class="col-md-12">
               <div class="our_two_box">
                  <div class="row d_flex">
                     <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">
                        <div class="our_img">
                           <figure>
                              <img src="{{ url_for('static', filename='UPLOAD_FOLDER/' ~ post.image) }}" alt="#" />
                           </figure>
                        </div>
                     </div>
                     <div class="col-xl-6 col-lg-6 col-md-12 col-sm-12">
                        <div class="our_text_box">
                           <h3 class="awesome pa_wi">{{ post.description }}</h3>
                           <p>{{ post.created_at }}</p>
                           <div class="post_box padding_bottom1">
                              <h4 class="flot_left1">Post By : {{ post.username }}</h4>
                              <ul class="like">
                                 <li>
                                    <button
                                       class="btn like-btn {% if post.id in liked_posts_ids %}btn-warning{% else %}btn-primary{% endif %}"
                                       data-post-id="{{ post.id }}"
                                       data-action="{% if post.id in liked_posts_ids %}unlike{% else %}like{% endif %}">
                                       {% if post.id in liked_posts_ids %}Dislike{% else %}Like{% endif %}
                                    </button>
                                 </li>
                                 <li><button class="btn comment-btn" data-toggle="modal"
                                       data-target="#commentModal{{ post.id }}">Comment</button></li>
                              </ul>
                           </div>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
<!-- Comment Modal -->
<div class="modal fade" id="commentModal{{ post.id }}" tabindex="-1" role="dialog" aria-labelledby="commentModalLabel{{ post.id }}" aria-hidden="true" data-post-id="{{ post.id }}">
   <div class="modal-dialog" role="document">
      <div class="modal-content">
         <div class="modal-header">
            <h5 class="modal-title" id="commentModalLabel{{ post.id }}">Comments</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
               <span aria-hidden="true">&times;</span>
            </button>
         </div>
         <div class="modal-body">
            <ul id="commentsList{{ post.id }}" class="list-group" style="max-height: 300px; overflow-y: auto;">
               <!-- Comments will be loaded here -->
            </ul>
            <div class="form-group mt-3">
               <textarea id="commentText{{ post.id }}" class="form-control" placeholder="Add a comment"></textarea>
            </div>
         </div>
         <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary submit-comment-btn" data-post-id="{{ post.id }}">Submit Comment</button>
         </div>
      </div>
   </div>
</div>

            <!-- End Comment Modal -->
            {% endfor %}
         </div>
      </div>
   </div>
   <!-- End Blog Main -->

   <!-- Testimonial -->
   <div class="section">
      <div id="" class="Testimonial">
         <div class="container">
            <div class="row">
               <div class="col-md-6 offset-md-3">
                  <div class="titlepage">
                     <h2>Testimonial</h2>
                  </div>
               </div>
            </div>
            <div class="row d_flex">
               <div class="col-md-3">
                  <div class="Testimonial_box">
                     <i><img src="../static/images/plan1.png" alt="#" /></i>
                  </div>
               
            </div>
            <div class="col-md-9">
               <div class="Testimonial_box">
                  <h4>John Doe</h4>
                  <p>It is a long established fact that a reader will be distracted by the readable content of a page
                     when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal
                     distribution of letters.</p>
               </div>
            </div>
         </div>
         <div class="row d_flex">
            <div class="col-md-9">
               <div class="Testimonial_box">
                  <h4>Jane Smith</h4>
                  <p>It is a long established fact that a reader will be distracted by the readable content of a page
                     when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal
                     distribution of letters.</p>
               </div>
            </div>
            <div class="col-md-3">
               <div class="Testimonial_box">
                  <i><img src="../static/images/plan2.png" alt="#" /></i>
               </div>
            </div>
         </div>
      </div>
   </div>
</div>
<!-- end Testimonial -->

<!--  footer -->
<footer>
   <div class="footer">
      <div class="container">
         <div class="row">
            <div class="col-md-12">
               <div class="cont">
                  <h3>Subscribe Now</h3>
                  <form class="main_form">
                     <input class="enter" placeholder="Enter your email" type="text" name="Enter your email">
                     <button class="submit">Subscribe</button>
                  </form>
               </div>
            </div>
            <div class="col-md-12">
               <ul class="social_icon">
                  <li><a href="#"><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
                  <li><a href="#"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
                  <li><a href="#"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li>
                  <li><a href="#"><i class="fa fa-instagram" aria-hidden="true"></i></a></li>
               </ul>
            </div>
         </div>
      </div>
      <div class="container">
         <div class="copy-right">
            <p>&copy; 2024 All Rights Reserved. Design by <a href="https://html.design/">Free HTML Templates</a></p>
         </div>
      </div>
   </div>
</footer>
<!-- end footer -->

<!-- Javascript files-->
<script src="../static/js/jquery.min.js"></script>
<script src="../static/js/popper.min.js"></script>
<script src="../static/js/bootstrap.bundle.min.js"></script>
<script src="../static/js/jquery-3.0.0.min.js"></script>
<script src="../static/js/plugin.js"></script>
<!-- Scrollbar Js Files -->
<script src="../static/js/jquery.mCustomScrollbar.concat.min.js"></script>
<script src="../static/js/custom.js"></script>
<script>
   $(document).ready(function () {
      // Function to load comments for a blog post
      function loadComments(postId) {
         $.ajax({
            url: '/comments/' + postId,
            method: 'GET',
            success: function (response) {
               var commentsList = $('#commentsList' + postId);
               commentsList.empty(); // Clear previous comments

               // Append each comment to the comments list
               response.comments.forEach(function (comment) {
                  var listItem = $('<li>').addClass('list-group-item').text(comment.comment_text);
                  commentsList.append(listItem);
               });

               // Show modal after comments are loaded
               $('#commentModal' + postId).modal('show');
            },
            error: function (xhr) {
               console.log('Error:', xhr.responseText);
            }
         });
      }

      // Submit comment functionality
      $(document).on('click', '.submit-comment-btn', function () {
         var postId = $(this).data('post-id');
         var commentText = $('#commentText' + postId).val();

         $.ajax({
            url: '/comment/' + postId,
            method: 'POST',
            data: { comment_text: commentText },
            success: function (response) {
               if (response.status === 'success') {
                  // Reload comments after submission
                  loadComments(postId);
                  $('#commentText' + postId).val(''); // Clear textarea
               } else {
                  alert('Error: ' + response.message);
               }
            },
            error: function (xhr) {
               console.log('Error:', xhr.responseText);
            }
         });
      });

      // Load comments when modal is shown (for existing comments)
      $(document).on('shown.bs.modal', function (e) {
         var postId = $(e.target).data('post-id');
         loadComments(postId);
      });

      // Like button functionality
      $('.like-btn').click(function () {
         var button = $(this);
         var postId = button.data('post-id');
         var action = button.data('action');

         $.ajax({
            url: '/' + action + '/' + postId,
            method: 'POST',
            success: function (response) {
               if (response.status === 'success') {
                  if (action === 'like') {
                     button.data('action', 'unlike').removeClass('btn-primary').addClass('btn-warning').text('Dislike');
                  } else {
                     button.data('action', 'like').removeClass('btn-warning').addClass('btn-primary').text('Like');
                  }
               } else {
                  alert('Error: ' + response.message);
               }
            },
            error: function (xhr) {
               console.log('Error:', xhr.responseText);
            }
         });
      });
   });
</script>
</body>

</html>
